<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <title>Editar Prática: <%= pratica.titulo %></title>
    
    <%- include('../partials/head') %>
</head>
<body class="poppins-regular bg-base">
    <%- include('../partials/navbar') %>

    <main class="container-signup">
        <h1 class="title">Editar Prática</h1>

        <form id="edit-pratica-form" class="form mt-4">
            <div class="form-element">
                <label for="titulo">Título da Prática</label>
                <input type="text" id="titulo" name="titulo" required class="input" value="<%= pratica.titulo %>" />
            </div>

            <div class="form-element">
                <label for="descricao">Descrição</label>
                <textarea id="descricao" name="descricao" class="input" rows="3"><%= pratica.descricao %></textarea>
            </div>

            <div class="form-element">
                <label for="turmaId">Associar à Turma</label>
                <select id="turmaId" name="turmaId" class="input" required>
                    <option value="" disabled>Selecione uma turma</option>
                    <% turmas.forEach(turma => { %>
                        <option value="<%= turma.id %>" <%= pratica.turmaId === turma.id ? 'selected' : '' %>>
                            <%= turma.nome %>
                        </option>
                    <% }) %>
                </select>
            </div>

            <h2 class="title-sm mt-4">Componentes Necessários</h2>
            
            <div class="componentes-form">
                <select id="componente-select" class="componentes-search">
                    <option value="">Selecione um componente para adicionar</option>
                    <% componentes.forEach(comp => { %>
                        <option value="<%= comp.nome %>"><%= comp.nome %></option>
                    <% }) %>
                </select>
                <button type="button" id="add-componente-btn">Adicionar</button>
            </div>

            <div id="lista-componentes-container" class="mt-3"></div>
            
            <input type="hidden" name="componentes" id="componentes-hidden-input" />
            <input type="hidden" id="pratica-id" value="<%= pratica.id %>" />

            <button type="submit" class="btn btn-primary mt-3">Salvar Alterações</button>
        </form>
    </main>

    <%- include('../partials/footer') %>

    <script>
      const componentesIniciais = <%- JSON.stringify(pratica.componentes || []) %>;
    </script>
    <script src="/js/professor.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => initializeEditPraticasForm(componentesIniciais));
    </script>
</body>
</html>